<div class="flexed max-width-600">
    <div>
        <a href="" class="button button-clear" style="padding: 0;"  onclick="searchGroups(); return showPage('groups');">&lt; Группы</a>
    </div>

    {{^group}}
    <h2>Новая группа <b id="newGroupName"></b></h2>
    {{/group}}
    {{#group}}
    <h2>Группа ( {{group.id}} ) &nbsp; <b id="newGroupName">{{group.groupname}}</b></h2>
    {{/group}}

    <form id="formGroup" onsubmit="event.preventDefault();">
        <div>
            <input name="id" type="hidden" value="{{group.id}}">
            <label >groupname *</label>
            <input name="groupname" type="text" placeholder="Имя группы"  value="{{group.groupname}}">
        </div>
        <div>
            <label >description</label>
            <input name="description" placeholder="описание. Например: Админка видео сервиса" value="{{group.description}}">
        </div>

        <div style="text-align: right;">
            <label></label>
            {{^group}}
            <button type="button" class="button button-outline" onclick="createGroup(event)" >создать</button>
            {{/group}}
            {{#group}}
            <button type="button" class="button button-outline" onclick="deleteGroup('{{group.id}}');">удалить</button>
            <button type="button" class="button button-outline" onclick="updateGroup(event)">сохранить</button>
            {{/group}}
        </div>
        <div id="groupError" class="error"></div>
    </form>

</div>


{{#app}}
    <div class="flexed">

    <div class="max-max-auto">
        <h2>Пользователи приложения</h2> 
        <h2><b>{{app.appname}}</b></h2>
        <span></span>
        <input placeholder="Фильтр" oninput="filterRows('#GroupUsers .filtered-row', this.value )">
    </div>


    <table id="GroupUsers">
        <tr>
            <th>пользователь</th>
            <th>полное имя</th>
            <th>роли</th>
        </tr>
            {{#app.users}}
            <tr class="filtered-row">
                <td><a href="" title="Редактировать" onclick="return showPage('user/{{username}}');">{{username}}</a></td>
                <td><a href="" title="Редактировать" onclick="return showPage('user/{{username}}');">{{user_fullname}}</a></td>
                <td>


                    {{#items}}
                    <button class="button button-outline role" 
                        onclick="modifyRole('delete', '{{app.appname}}', '{{username}}','{{rolename}}',()=>{ getGroup('{{app.appname}}') } )"
                        >
                        {{rolename}}
                    </button>
                    {{/items}} 
                    <span class="button button-outline role-nocross">
                        <input id="newRoleName-{{username}}" class="role-input">
                        <button class="button button-outline role-add" 
                            onclick="modifyRole('create', '{{app.appname}}', '{{username}}', document.getElementById('newRoleName-{{username}}').value, ()=>{ getGroup('{{app.appname}}') }  )"
                            >
                        +
                        </button>
                    </span>




                </td>
            </tr>
            {{/app.users}}

        <tr>
            <td>                
                <input id="newGroupUsername" 
                    list="usersDataList" 
                    placeholder="Добавить пользователя. Поиск." 
                    onchange="document.getElementById('newGroupUserFullName').innerText = document.querySelector(`#usersDataList>option[value='${this.value}'`).innerText;"
                >
                <datalist id="usersDataList">
                    {{{all_user_options}}}
                </datalist>
            </td>
            <td id="newGroupUserFullName">
            </td>
            <td>
                <span class="button button-outline role-nocross">
                        <input id="newGroupRolename" class="role-input"  placeholder="новая роль">
                        <button class="button button-outline role-add" 
                            onclick="modifyRole('create', '{{app.appname}}', document.getElementById('newGroupUsername').value, document.getElementById('newGroupRolename').value, ()=>{ getGroup('{{app.appname}}') }  )"
                            >
                        +
                        </button>
                </span>
            </td>
        </tr>

        

    </table>
</div>
{{/app}}


